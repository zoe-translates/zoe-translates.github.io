(()=>{var x=(e,t,n)=>new Promise((r,o)=>{var s=l=>{try{a(n.next(l))}catch(i){o(i)}},c=l=>{try{a(n.throw(l))}catch(i){o(i)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,c);a((n=n.apply(e,t)).next())});var E={noResults:"No results found."},d={indexURI:"/searchindex.json",lunrLanguages:["en","fr","ru"],maxSummaryLength:100};var f,g;function C(){return x(this,null,function*(){try{let e=yield fetch(d.indexURI);if(e.status!==200)return;f=yield e.json(),g=lunr(function(){if(Array.isArray(d.lunrLanguages)){let t=new Set;d.lunrLanguages.forEach(r=>t.add(r)),t.add("en");let n=lunr.multiLanguage(...t);this.use(n)}this.field("author"),this.field("title"),this.field("tag"),this.field("section"),this.field("content"),this.ref("revid"),this.metadataWhitelist=["position"],f.forEach(t=>this.add(t))}),document.dispatchEvent(new CustomEvent("indexed"))}catch(e){console.log(e)}})}var B=document.querySelector("template").content;function R(e){if(!e){p();return}let t=k(e);if(!t.length){P(E.noResults),p();return}T(),b(e,t)}function k(e){let t=e,n=A(e),r;try{r=L(n)}catch(o){if(o instanceof lunr.QueryParseError)return[];throw o}return r.length>0?r:n!==t?L(t):[]}function L(e){return typeof g=="undefined"?[]:g.search(e).map(t=>{let n=f[t.ref];return n.score=t.score,n.metadata=t.matchData.metadata,n})}function A(e){let t=e.split(" ");if(t.length===1)return e;let n="";for(let r of t)n+=`+${r} `;return n.trim()}function P(e){let t=document.querySelector(".search-container");t.classList.add("form-item-error"),t.classList.remove("focused"),document.querySelector(".search-error-message").textContent=e,document.querySelector(".search-error").classList.remove("hide-element")}function T(){let e=document.querySelector(".search-container");e.classList.add("focused"),e.classList.remove("form-item-error"),document.querySelector(".search-error").classList.add("hide-element"),document.querySelector(".search-error-message").textContent=""}function p(){document.getElementById("site-search").classList.remove("expanded"),document.getElementById("search-results").classList.add("hide-element")}function b(e,t){q(),M(e,t),D()}function q(){document.getElementById("search-results-body").textContent="",document.getElementById("results-count").textContent=""}function M(e,t){let n=document.createDocumentFragment(),r=document.getElementById("search-results-body");r.textContent="";for(let o in t){let s=t[o],c=B.cloneNode(!0),a=Q(s.metadata),l=c.querySelector("article");l.dataset.score=s.score.toFixed(2);let i=c.querySelector("a");i.href=s.href,i.innerHTML=a.title?w(s.title,a.title):s.title;let h=c.querySelector(".tm-date");h.textContent=s.date;let m=c.querySelector(".tm-author");m.innerHTML=a.author?w(s.author,a.author):s.author;let u=c.querySelector(".post-content");u.innerHTML=_(e,s.content),n.appendChild(c)}r.appendChild(n),document.getElementById("results-count").textContent=t.length}function Q(e){let t={};for(let[,r]of Object.entries(e))for(let[o,{position:s}]of Object.entries(r)){t[o]||(t[o]=[]);for(let[c,a]of s)t[o].push([c,c+a])}let n;for(let r in t)n=t[r],n.sort((o,s)=>o-s),t[r]=O(n);return t}function O(e){if(!e.length)return e;let t=[],n=0,r=e[0][1];t[0]=e[0];for(let[o,s]of e.slice(1))o<=r?s>r&&(t[n][1]=s,r=s):(t.push([o,s]),r=s,n++);return t}function w(e,t){let n=[],r=0;for(let[o,s]of t)n.push(e.slice(r,o)),n.push('<mark class="search-item">'),n.push(e.slice(o,s)),n.push("</mark>"),r=s;return n.push(e.slice(r)),n.join("")}function _(e,t){let n=new RegExp($(e),"gmi"),r=new RegExp(/(?=[^])(?:\P{Sentence_Terminal}|\p{Sentence_Terminal}(?!['"`\p{Close_Punctuation}\p{Final_Punctuation}\s]))*(?:\p{Sentence_Terminal}+['"`\p{Close_Punctuation}\p{Final_Punctuation}]*|$)/,"guy"),o=Array.from(t.matchAll(n),i=>i.index),s=Array.from(t.matchAll(r),i=>i.index),c="",a="",l=0;for(let i of o){if(i>l){for(let u=0;u<s.length;u++)if(s[u]>i){let I=u>0?s[u-1]+1:0,y=s[u];l=y,c=t.slice(I,y).trim(),a+=`${c} ... `;break}}let h=v(a),m=h.filter(u=>u.length>50);if(m.length>0&&(a=j(a,m)),h.length>=d.maxSummaryLength)break}return H(a,d.maxSummaryLength).replace(n,'<mark class="search-item">$&</mark>')}function $(e){let t=RegExp.escape(e);return t.split(" ").length===1?`(${t})`:`(${t.split(" ").join("|")})`}function v(e){let t=/\b(\w*)[\W|\s|\b]?/gm;return Array.from(e.matchAll(t),r=>r).map(r=>({word:r[0],start:r.index,end:r.index+r[0].length,length:r[0].length}))}function j(e,t){return t.forEach(n=>{let r=F(n.word,20);e=e.replace(n.word,r)}),e}function F(e,t){let n="",r=e.length/t|0,o=e.length%t>0;o&&(r+=1);for(let s=0;s<r;s++){let c=s*t,a=c+t;o&&s===r-1&&(a=e.length),n+=e.slice(c,a)+" "}return n}function D(){document.getElementById("search-results").classList.remove("hide-element"),document.getElementById("site-search").classList.remove("expanded")}function H(e,t){let n=v(e);return n.length<=t?e:e.slice(0,n[t].end)+"..."}Object.prototype.hasOwnProperty.call(RegExp,"escape")||(RegExp.escape=function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")});String.prototype.matchAll||(String.prototype.matchAll=function(e){function t(r,o){return r.includes(o)?r:r+o}function*n(r,o){let s=new RegExp(o,t(o.flags,"g")),c;for(;c=s.exec(r);)c.index=s.lastIndex-c[0].length,yield c}return n(this,e)});function U(e){return new Proxy(new URLSearchParams(window.location.search),{get:(n,r)=>n.get(r)})[e]}C();document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search-form"),t=document.getElementById("search");e===null||t===null||(e.addEventListener("submit",n=>n.preventDefault()),t.addEventListener("keyup",n=>{n.preventDefault();let r=document.getElementById("search").value.trim().toLowerCase();R(r)}),t.addEventListener("input",n=>{n.currentTarget.value||p()}))});document.addEventListener("indexed",()=>{let e=U("q");e&&(document.getElementById("search").value=e,R(e))});})();
