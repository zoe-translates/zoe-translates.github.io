"use strict";(()=>{var y={noResults:"No results found."},a={indexURI:"/searchindex.json",lunrLanguages:["en","ru"],maxHitsPerResult:5,maxResults:25};var R,A,X=fetch(a.indexURI);document.getElementById("search-app").classList.remove("hide-element");var Y=new RegExp(/[\u0300-\u036f]/g);function v(e){return e.normalize("NFD").replace(Y,"")}var Z=document.getElementById("search-display-tpl").content.querySelector("article"),P=document.createElement("mark");P.className="search-hit";var E=document.getElementById("search-output-region"),F=document.getElementById("search-input-container"),M=document.getElementById("search-error-container"),H=document.getElementById("search-error-content"),U=document.getElementById("search-results"),q=document.getElementById("results-count"),S=document.getElementById("search-results-body"),d=document.getElementById("search"),D,I=!1;function Q(e){se();let t=ee(e);if(D=e,!t.length){I=!0,w(y.noResults),z(),x();return}I=!1,W(),S.textContent="",q.textContent="",ce(e,t),$(),x()}function ee(e){let t=ne(e);if(!t)return[];try{return A.search(t)}catch(n){if(n instanceof lunr.QueryParseError)return[];throw n}}var j=new RegExp("\\p{sc=Han}","u");function te(e){return j.test(e)?!0:e.startsWith("+")||e.startsWith("-")?e.length>2:e.length>1}function ne(e){let t=e.split(" ").filter(te);return t.every(n=>n.startsWith("-"))?"":t.join(" ")}function oe(){d.removeAttribute("readonly");let e=document.getElementById("search-act");e&&e.removeAttribute("disabled"),d.removeAttribute("placeholder"),d.focus()}function w(e){F.classList.add("form-item-error"),H.textContent=e,M.classList.remove("hide-element")}function W(){M.classList.add("hide-element"),F.classList.remove("form-item-error"),H.textContent=""}function se(){E.ariaBusy="true",E.setAttribute("aria-busy","true")}function x(){E.ariaBusy="false",E.setAttribute("aria-busy","false")}function $(){U.classList.remove("hide-element")}function z(){U.classList.add("hide-element")}function re(e){let t=P.cloneNode(!1);return t.textContent=e,t}var G=document.createElement("span");G.className="ell";function p(e){let t=G.cloneNode(!1);return t.textContent=e,t}function B(e,t,n){let o=[];n?J(o,t,n):o.push(t),e.append(...o)}var b=new DocumentFragment;function ce(e,t){let n;a.maxResults<=0?n=t.length:n=Math.min(t.length,a.maxResults);for(let o=0;o<n;o++){let s=t[o],r=R[s.ref],c=ie(s.matchData.metadata),i=Z.cloneNode(!0),l=i.querySelector("a");B(l,r.title,c.title),l.href=new URL(r.href,location.origin).href;let f=i.querySelector(".tm-date");f.textContent=r.date;let g=i.querySelector(".tm-author");B(g,r.author,c.author);let h=i.querySelector(".post-content"),u;if(c.content)u=fe(r.content,c.content);else{let N=C(r.content,100,0,-1);u=[r.content.slice(0,N)],r.content.length>N&&u.push(p(" \u2026"))}h.append(...u),i.dataset.score=s.score.toFixed(2),i.normalize(),b.appendChild(i)}q.textContent=t.length.toString(),S.textContent="",S.appendChild(b)}function ie(e){let t={};for(let[,n]of Object.entries(e))for(let[o,{position:s}]of Object.entries(n)){t[o]||(t[o]=[]);for(let[r,c]of s)t[o].push([r,r+c])}for(let[n,o]of Object.entries(t))o.sort((s,r)=>s[0]-r[0]),t[n]=le(o);return t}function le(e){if(!e.length)return e;let t=[],n=0,o=e[0][1];t[0]=e[0];for(let[s,r]of e.slice(1))s>o?(t.push([s,r]),o=r,n++):r>o&&(t[n][1]=r,o=r);return t}function J(e,t,n,o=0){let s=0;for(let[r,c]of n)r-=o,c-=o,e.push(t.slice(s,r)),e.push(re(t.slice(r,c))),s=c;e.push(t.slice(s))}function ue(e,t,n){if(!t.length)return[];let o=e.length,s=a.maxHitsPerResult<=0?t.length:a.maxHitsPerResult,[r,c]=t[0],i=[{context:O(r-n,c+n,o),mark:[[r,c]]}],l=i[0],f,g;for(let[h,u]of t.slice(1,s))[f,g]=O(h-n,u+n,o),[r,c]=l.context,f<=c?(l.context[1]=g,l.mark.push([h,u])):(l={},l.context=[f,g],l.mark=[[h,u]],i.push(l));return i.forEach(h=>{ae(h,e)}),i}var m=new RegExp("[\\p{L}\\p{gc=Mark}\\p{gc=Connector_Punctuation}\\p{Join_Control}]","u");function C(e,t,n,o=1){if(t===0&&o>0||t===e.length&&o<0||j.test(e[t]))return t;if(o>0){if(m.test(e[t])&&!m.test(e[t-1]))return t}else if(o<0&&m.test(e[t-1])&&!m.test(e[t]))return t;let s,r=!0,c=!1;for(s=t;o*(s-n)<0;s+=o){if(r){if(m.test(e[s]))continue;r=!1,c=!0}if(c){if(!m.test(e[s]))continue;break}}return s+(o<0)}function ae(e,t){let n=e.context[0];e.context[0]=C(t,n,e.mark[0][0]),n=e.context[1],e.context[1]=C(t,n,e.mark.at(-1)[1],-1)}function O(e,t,n){return[Math.max(0,e),Math.min(t,n)]}function fe(e,t,n=45){let o=[],s=ue(e,t,n);o.push(p(s[0].context[0]>0?"\u2026 [":"["));let r=s.length-1;for(let c=0;c<=r;c++){let i=s[c],l=i.context[0],f=e.slice(...i.context);J(o,f,i.mark,l),c!=r&&o.push(p("] \u2026 ["))}return o.push(p(s.at(-1).context[1]<e.length?"] \u2026":"]")),o}function L(e){return v(e).split(/\s/).filter(Boolean).join(" ").toLowerCase()}var k=document.title;function _(e){document.title=e.length?k.replace(/^.+ -/,`( ${e} ) at`):k}function he(e){let t=e.state?e.state:"";V(L(t)),d.value=t,_(t)}function de(e,t){let n=`${t}`;n=n&&`?${n}`,window.history.pushState(e,"",`${location.pathname}${n}`),_(e)}var K=new Proxy(new URLSearchParams(location.search),{get:(e,t)=>e.get(t.toLowerCase()),set:(e,t,n)=>(t=t.toLowerCase(),n?e.set(t,n):e.delete(t),t==="q"&&de(n,e),!0)});function V(e){if(!e){W(),z();return}if(e===D){I?w(y.noResults):$();return}Q(e)}function me(e){e.preventDefault();let t=L(d.value);V(t),K.q=d.value}function ge(){let e=K.q;if(e){let t=L(e);t&&Q(t),d.value=e,window.history.replaceState(e,"",""),_(e)}}X.then(e=>e.ok?e.json():Promise.reject("Fetch response not ok")).then(e=>{R=e;function t(n){function o(s){return s.update(()=>v(s.toString()))}lunr.Pipeline.registerFunction(o,"processDiac"),n.pipeline.before(lunr.stemmer,o)}A=lunr(function(){if(Array.isArray(a.lunrLanguages)){let n=new Set;a.lunrLanguages.forEach(s=>n.add(s)),n.add("en");let o=lunr.multiLanguage(...n);this.use(o)}this.use(t),this.field("author"),this.field("title"),this.field("content"),this.ref("revid"),this.metadataWhitelist=["position"],this.k1(1.05),this.b(.6),R.forEach(n=>this.add(n))}),ge(),window.addEventListener("popstate",he),document.getElementById("search-form").addEventListener("submit",me),oe()}).catch(e=>{w("Error: Failed to load search data. Try reloading page?"),console.error(e)});})();
